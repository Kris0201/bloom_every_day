import{b as g}from"./bootstrap.bundle.min-ccc122ff.js";import{s as O}from"./setAuthFactory-2f9bf77f.js";import{d as M,a as L}from"./date-4f67e89e.js";import{P as C}from"./PaginationComponent-fe886316.js";import{S as y}from"./sweetalert2.all-4e1800ee.js";import{_ as B,r as v,o as l,c as i,e as f,d as t,F as h,y as m,t as n,C as D,N as E,z as P,p as S,g as V}from"./index-c62a27fd.js";const{VITE_URL:p,VITE_PATH:u}={VITE_URL:"https://vue3-course-api.hexschool.io/",VITE_PATH:"bloom-api",BASE_URL:"/bloom_every_day/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},I={data(){return{orders:[],tempOrder:{user:{}},isLoading:!1,fullPage:!0,page:{}}},components:{Pagination:C},methods:{date:M,getOrderList(d=1){this.isLoading=!0,this.$http.get(`${p}v2/api/${u}/admin/orders/?page=${d}`).then(a=>{console.log(a.data),this.orders=a.data.orders,this.page=a.data.pagination,this.isLoading=!1}).catch(a=>{console.log(a)})},openModal(d){this.tempOrder={...d},this.orderModal.show()},confirmUpdate(d){console.log(d),this.isLoading=!0;const a=d.id,b={is_paid:d.is_paid,paid_date:L()/1e3};this.$http.put(`${p}v2/api/${u}/admin/order/${a}`,{data:b}).then(_=>{this.isLoading=!1,this.getOrderList(),this.orderModal.hide(),y.fire({toast:!0,position:"top",showConfirmButton:!1,timer:2e3,title:'<h6 class="mb-0" style="color:#FF3D33; text-align:center;">已更新訂單付款狀態！</h6>'}),console.log(_)}).catch(_=>{console.log(_)})},openDeleteModal(d){this.tempOrder={...d},this.delModal.show()},deleteOrder(){this.isLoading=!0,this.$http.delete(`${p}v2/api/${u}/admin/order/${this.tempOrder.id}`).then(()=>{this.isLoading=!1,this.delModal.hide(),this.getOrderList(),y.fire({toast:!0,position:"top",showConfirmButton:!1,timer:2e3,title:'<h6 class="mb-0" style="color:#FF3D33; text-align:center;">已刪除訂單！</h6>'})}).catch(d=>{console.log(d)})}},mounted(){O(this.$http,this.$router),this.orderModal=new g.Modal(this.$refs.orderModal),this.delModal=new g.Modal(this.$refs.deleteModal),this.getOrderList()}},o=d=>(S("data-v-4eda4254"),d=d(),V(),d),F={class:"order container"},U=o(()=>t("h5",{class:"admin_title_h5"},"訂單管理頁面",-1)),A={class:"row mx-auto"},T={class:"col-sm-12 p-0"},R={class:"table mt-4 order_table"},N=o(()=>t("tr",null,[t("th",null,"購買時間"),t("th",null,"Email"),t("th",null,"購買款項"),t("th",null,"應付金額"),t("th",null,"是否付款"),t("th",null,"編輯")],-1)),j={"data-th":"購買時間"},q={"data-th":"Email"},H={"data-th":"購買款項"},z={class:"order_item",style:{"list-style-position":"inside","margin-bottom":"0px"}},G={"data-th":"應付金額"},J={"data-th":"是否付款"},K={key:0,class:"text-neutral"},Q={key:1,class:"text-primary",style:{"font-weight":"bold"}},W={class:"btn_td","data-th":"編輯"},X=["onClick"],Y=["onClick"],Z={class:"modal fade",id:"orderModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"orderModal"},$={class:"modal-dialog modal-xl",role:"document"},tt={class:"modal-content border-0"},st=o(()=>t("div",{class:"modal-header bg-bg-2 text-dark-text"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},[t("span",null,"訂單細節")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),et={class:"modal-body"},ot={class:"row mx-auto"},dt={class:"col-md-5"},at=o(()=>t("h4",{class:"bg-bg-2",style:{padding:"0 0 0 6px"}},"用戶資料",-1)),lt={class:"table"},it={class:"row mx-auto"},nt=o(()=>t("td",{class:"col-3 col-md-5"},"姓名",-1)),ct={class:"col-9 col-md-7 wordBreak"},rt={class:"row mx-auto"},_t=o(()=>t("td",{class:"col-3 col-md-5"},"Email",-1)),ht={class:"col-9 col-md-7 wordBreak"},mt={class:"row mx-auto"},pt=o(()=>t("td",{class:"col-3 col-md-5"},"電話",-1)),ut={class:"col-9 col-md-7 wordBreak"},bt={class:"row mx-auto"},gt=o(()=>t("td",{class:"col-3 col-md-5"},"地址",-1)),yt={class:"col-9 col-md-7 wordBreak"},vt={class:"col-md-7"},ft=o(()=>t("h4",{class:"bg-bg-2",style:{padding:"0 0 0 6px"}},"訂單細節",-1)),xt={class:"table"},kt={class:"row mx-auto"},wt=o(()=>t("td",{class:"col-5 col-md-6"},"訂單編號",-1)),Ot={class:"col-7 col-md-6 wordBreak"},Mt={class:"row mx-auto"},Lt=o(()=>t("td",{class:"col-5 col-md-6"},"下單時間",-1)),Ct={class:"col-7 col-md-6 wordBreak"},Bt={class:"row mx-auto"},Dt=o(()=>t("td",{class:"col-5 col-md-6"},"付款時間",-1)),Et={class:"col-7 col-md-6 wordBreak"},Pt={key:0},St={key:1,class:"text-primary"},Vt={class:"row mx-auto"},It=o(()=>t("td",{class:"col-5 col-md-6"},"付款狀態",-1)),Ft={class:"col-7 col-md-6 wordBreak"},Ut={key:0,class:"text-neutral"},At={key:1,class:"text-primary"},Tt={class:"row mx-auto"},Rt=o(()=>t("td",{class:"col-5 col-md-6"},"總金額",-1)),Nt={class:"col-7 col-md-6"},jt=o(()=>t("h4",{class:"bg-bg-2",style:{padding:"0 0 0 6px"}},"選購商品清單",-1)),qt={class:"table"},Ht={class:"order_item",style:{"list-style-position":"inside","margin-bottom":"0px",padding:"0"}},zt={class:"d-flex justify-content-end"},Gt={class:"form-check"},Jt={class:"form-check-label",for:"flexCheckDefault"},Kt={key:0},Qt={key:1},Wt={class:"modal-footer"},Xt=o(()=>t("button",{type:"button",class:"btn btn-outline-neutral btn_cancel","data-bs-dismiss":"modal"}," 取消 ",-1)),Yt={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"deleteModal"},Zt={class:"modal-dialog",role:"document"},$t={class:"modal-content border-0"},ts=P('<div class="modal-header bg-primary text-white" data-v-4eda4254><h5 class="modal-title" data-v-4eda4254><span data-v-4eda4254>刪除</span></h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" data-v-4eda4254></button></div><div class="modal-body" data-v-4eda4254> 是否刪除這筆訂單？<strong class="text-danger" data-v-4eda4254></strong> (刪除後將無法恢復)。 </div>',2),ss={class:"modal-footer"},es=o(()=>t("button",{type:"button",class:"btn btn_cancel btn-outline-neutral","data-bs-dismiss":"modal"}," 取消 ",-1));function os(d,a,b,_,s,c){const x=v("vue-loading"),k=v("Pagination");return l(),i(h,null,[f(x,{active:s.isLoading,"onUpdate:active":a[0]||(a[0]=e=>s.isLoading=e),"is-full-page":s.fullPage,opacity:1},null,8,["active","is-full-page"]),t("div",F,[U,t("div",A,[t("div",T,[t("table",R,[N,(l(!0),i(h,null,m(s.orders,e=>(l(),i("tr",{key:e.id},[t("td",j,n(c.date(e.create_at)),1),t("td",q,n(e.user.email),1),t("td",H,[t("ol",z,[(l(!0),i(h,null,m(e.products,(r,w)=>(l(),i("li",{key:w},n(r.product.title)+" 數量："+n(r.qty),1))),128))])]),t("td",G,n(e.total),1),t("td",J,[e.is_paid?(l(),i("span",K," 已付款 ")):(l(),i("span",Q," 未付款 "))]),t("td",W,[t("div",null,[t("button",{class:"btn btn_edit btn-outline-neutral me-3",type:"button",onClick:r=>c.openModal(e)}," 檢視 ",8,X),t("button",{class:"btn btn_delete btn-outline-primary",type:"button",onClick:r=>c.openDeleteModal(e)}," 刪除 ",8,Y)])])]))),128))])])]),f(k,{pages:s.page,onChangePage:c.getOrderList},null,8,["pages","onChangePage"]),t("div",Z,[t("div",$,[t("div",tt,[st,t("div",et,[t("div",ot,[t("div",dt,[at,t("table",lt,[t("tbody",null,[t("tr",it,[nt,t("td",ct,n(s.tempOrder.user.name),1)]),t("tr",rt,[_t,t("td",ht,n(s.tempOrder.user.email),1)]),t("tr",mt,[pt,t("td",ut,n(s.tempOrder.user.tel),1)]),t("tr",bt,[gt,t("td",yt,n(s.tempOrder.user.address),1)])])])]),t("div",vt,[ft,t("table",xt,[t("tbody",null,[t("tr",kt,[wt,t("td",Ot,n(s.tempOrder.id),1)]),t("tr",Mt,[Lt,t("td",Ct,n(c.date(s.tempOrder.create_at)),1)]),t("tr",Bt,[Dt,t("td",Et,[s.tempOrder.paid_date?(l(),i("span",Pt,n(c.date(s.tempOrder.paid_date)),1)):(l(),i("span",St,"時間不正確"))])]),t("tr",Vt,[It,t("td",Ft,[s.tempOrder.is_paid?(l(),i("span",Ut,"已付款")):(l(),i("span",At,"尚未付款"))])]),t("tr",Tt,[Rt,t("td",Nt,n(s.tempOrder.total),1)])])]),jt,t("table",qt,[t("tbody",null,[t("tr",null,[t("td",null,[t("ol",Ht,[(l(!0),i(h,null,m(s.tempOrder.products,(e,r)=>(l(),i("li",{key:r},n(e.product.title)+" 數量："+n(e.qty),1))),128))])])])])]),t("div",zt,[t("div",Gt,[D(t("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":a[1]||(a[1]=e=>s.tempOrder.is_paid=e)},null,512),[[E,s.tempOrder.is_paid]]),t("label",Jt,[s.tempOrder.is_paid?(l(),i("span",Kt,"已付款")):(l(),i("span",Qt,"未付款"))])])])])])]),t("div",Wt,[Xt,t("button",{type:"button",class:"btn btn-outline-primary btn_confirm",onClick:a[2]||(a[2]=e=>c.confirmUpdate(s.tempOrder))}," 修改付款狀態 ")])])])],512),t("div",Yt,[t("div",Zt,[t("div",$t,[ts,t("div",ss,[es,t("button",{type:"button",class:"btn btn-danger",onClick:a[3]||(a[3]=(...e)=>c.deleteOrder&&c.deleteOrder(...e))},"確認刪除")])])])],512)])],64)}const rs=B(I,[["render",os],["__scopeId","data-v-4eda4254"]]);export{rs as default};
